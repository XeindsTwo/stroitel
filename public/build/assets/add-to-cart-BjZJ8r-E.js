const d=document.querySelectorAll(".form");d.forEach(t=>{const s=t.querySelector(".quantity"),i=t.querySelector(".plus"),c=t.querySelector(".minus");let e=1;s.value=e,i.addEventListener("click",()=>{e++,s.value=e}),c.addEventListener("click",()=>{e>1&&(e--,s.value=e)}),t.addEventListener("submit",async l=>{l.preventDefault();const n=parseInt(s.value.trim());if(isNaN(n)||n<1){u("Минимальное количество товара в корзину - 1");return}else if(n>1e3){u("Максимальное количество товара в корзине - 1000");return}try{const o=t.querySelector('input[name="product_id"]').value,r=await fetch(`/add-to-cart/${o}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({product_id:o,quantity:n})}),a=await r.json();if(r.status===401)throw new Error(a.message);if(r.status===402)throw new Error(a.message);if(r.status===403)throw new Error(a.message);if(r.status===400)throw new Error(a.message);if(!r.ok)throw new Error("Ошибка при добавлении товара в корзину");u("Товар успешно добавлен в корзину")}catch(o){u(o.message)}})});function u(t){Toastify({text:t,duration:3e3,gravity:"bottom",position:"right"}).showToast()}
